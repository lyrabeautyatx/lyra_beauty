<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login - Lyra Beauty</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
</head>
<body class="gold-bg">
  <div class="container" style="max-width: 420px;">
    <h2 class="text-center mb-4">Login</h2>
    <% if (error) { %>
      <p class="alert alert-danger text-center"><%= error %></p>
    <% } %>

    <!-- Google OAuth Login/Signup -->
    <div class="mb-2 text-center">
      <a href="/auth/google" class="btn btn-primary w-100 mb-2" id="google-signin">
        <svg width="18" height="18" viewBox="0 0 18 18" style="margin-right: 8px; vertical-align:middle;"><path fill="#4285f4" d="M17.64 9.2c0-.64-.06-1.26-.16-1.84H9v3.48h4.84a4.14 4.14 0 0 1-1.8 2.72v2.26h2.92c1.7-1.56 2.68-3.86 2.68-6.62z"/><path fill="#34a853" d="M9 18c2.43 0 4.47-.8 5.96-2.18l-2.92-2.26a5.41 5.41 0 0 1-8.09-2.85h-3v2.33A9 9 0 0 0 9 18z"/><path fill="#fbbc05" d="M3.96 10.71a5.41 5.41 0 0 1 0-3.42V4.96h-3a9 9 0 0 0 0 8.08l3-2.33z"/><path fill="#ea4335" d="M9 3.58c1.32 0 2.5.45 3.44 1.34l2.58-2.58A9 9 0 0 0 .96 4.96l3 2.33A5.36 5.36 0 0 1 9 3.58z"/></svg>
        Sign in with Google
      </a>
      <a href="/auth/google-signup" class="btn btn-success w-100" id="google-signup">
        <svg width="18" height="18" viewBox="0 0 18 18" style="margin-right: 8px; vertical-align:middle;"><path fill="#4285f4" d="M17.64 9.2c0-.64-.06-1.26-.16-1.84H9v3.48h4.84a4.14 4.14 0 0 1-1.8 2.72v2.26h2.92c1.7-1.56 2.68-3.86 2.68-6.62z"/><path fill="#34a853" d="M9 18c2.43 0 4.47-.8 5.96-2.18l-2.92-2.26a5.41 5.41 0 0 1-8.09-2.85h-3v2.33A9 9 0 0 0 9 18z"/><path fill="#fbbc05" d="M3.96 10.71a5.41 5.41 0 0 1 0-3.42V4.96h-3a9 9 0 0 0 0 8.08l3-2.33z"/><path fill="#ea4335" d="M9 3.58c1.32 0 2.5.45 3.44 1.34l2.58-2.58A9 9 0 0 0 .96 4.96l3 2.33A5.36 5.36 0 0 1 9 3.58z"/></svg>
        Sign up with Google
      </a>
      <div class="small text-muted mt-2" id="oauth-status">Google Sign-In and Sign-Up available</div>
    </div>

    <div class="divider mb-4"><hr><span>or</span><hr></div>

    <!-- Legacy Login Form -->
    <form method="POST" action="/login" class="mb-3">
      <div class="mb-3">
        <input type="text" name="username" class="form-control form-control-lg" placeholder="Username" required>
      </div>
      <div class="mb-3">
        <input type="password" name="password" class="form-control form-control-lg" placeholder="Password" required>
      </div>
  <button type="submit" class="btn btn-secondary w-100">Login with Username</button>
    </form>
    <div class="text-center">
      <span class="legacy-note">Note: Username/password login is for development. Use Google Sign-In for production.</span>
    </div>
    <div class="my-4 text-center">
      <button id="show-signup" type="button" class="btn btn-outline-primary" style="margin-top:10px;">Create an account</button>
    </div>
    <form id="signup-form" method="POST" action="/signup" style="display:none; margin-top:10px;">
      <div class="mb-3">
        <input type="text" name="new_username" class="form-control" placeholder="Choose a username" required>
      </div>
      <div class="mb-3">
        <input type="password" name="new_password" class="form-control" placeholder="Choose a password" required>
      </div>
  <button type="submit" class="btn btn-primary w-100">Sign Up</button>
      <p class="legacy-note mt-2">Sign up for a basic account. No email required.</p>
    </form>
  </div>

  <script>
    // Check if OAuth is configured
    fetch('/auth/status')
      .then(response => response.json())
      .then(data => {
        if (!data.oauthAvailable) {
          document.getElementById('google-signin').style.display = 'none';
          document.getElementById('oauth-status').textContent = 'Google OAuth not configured. Using legacy login.';
          document.getElementById('oauth-status').style.color = '#f39c12';
        }
      })
      .catch(() => {
        // OAuth status check failed, hide Google button
        document.getElementById('google-signin').style.display = 'none';
        document.getElementById('oauth-status').textContent = 'Google OAuth not available. Using legacy login.';
        document.getElementById('oauth-status').style.color = '#f39c12';
      });

    // Toggle sign up form
    document.getElementById('show-signup').addEventListener('click', function() {
      var form = document.getElementById('signup-form');
      form.style.display = form.style.display === 'none' ? 'block' : 'none';
    });
  </script>
</body>
</html>
